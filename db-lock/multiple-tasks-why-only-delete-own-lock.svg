<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="612" height="907"><desc>Task1-%3ELockDb%3ACheck%20if%20locked%0ATask1%3C--LockDb%3ANo%20lock%0ATask2-%3ELockDb%3ACheck%20if%20locked%0ATask2%3C--LockDb%3ANo%20lock%0ATask1-%3ELockDb%3ARequest%20lock%3A%20new%20lock%20entry%5Cn(id%3A%20lock_id1%2C%20status%3A%20ACTIVE)%0ATask1-%3ELockDb%3ACheck%20ACTIVE%20locks%0ATask1%3C--LockDb%3AReturn%20lock%20id%5Cn(Lock%20obtained)%0A%0ATask2-%3ELockDb%3ARequest%20lock%3A%20new%20lock%20entry%5Cn(id%3A%20lock_id2%2C%20status%3A%20ACTIVE)%0ATask2-%3ELockDb%3ACheck%20ACTIVE%20locks%0ATask2%3C--LockDb%3AReturn%20other%20lock%20ids%5Cn(Race%20Condition)%0ATask2-%3ELockDb%3ACancel%20lock%3A%20update%20lock%5Cn(status%3A%20ABORTED)%0Anote%20over%20Task2%3A%20Back%20off%5Cn(random%20duration)%0Anote%20over%20Task1%3A%20Do%20work%0Anote%20over%20Task2%3A%20Retry</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="612" height="907"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 58.036886270000004 55.049635120999994 L 58.036886270000004 907.747247381" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 290.5974284033333 55.049635120999994 L 290.5974284033333 907.747247381" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.1579705366667 55.049635120999994 L 523.1579705366667 907.747247381" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 21.313190689499997 10.944586211000003 L 94.76058185050002 10.944586211000003 L 94.76058185050002 55.049635120999994 L 21.313190689499997 55.049635120999994 L 21.313190689499997 10.944586211000003 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="39.036886270000004" y="38.71443182099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Task1</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 247.8737328228333 10.944586211000003 L 333.32112398383333 10.944586211000003 L 333.32112398383333 55.049635120999994 L 247.8737328228333 55.049635120999994 L 247.8737328228333 10.944586211000003 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.5974284033333" y="38.71443182099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">LockDb</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 486.43427495616663 10.944586211000003 L 559.8816661171667 10.944586211000003 L 559.8816661171667 55.049635120999994 L 486.43427495616663 55.049635120999994 L 486.43427495616663 10.944586211000003 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="504.15797053666665" y="38.71443182099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Task2</text></g></g><g><g><g><rect fill="white" stroke="none" x="122.36687684166667" y="87.720041721" width="103.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="124.81715733666667" y="102.42172469100001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Check if locked</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 58.036886270000004 108.95580601099999 L 277.14811101966666 108.95580601099999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(290.5974284033333,108.95580601099999) translate(-290.5974284033333,-108.95580601099999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 276.98475898666663 102.14947130266665 L 290.5974284033333 108.95580601099999 L 276.98475898666663 115.76214071933333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="147.86687684166668" y="133.458610961" width="52.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="150.31715733666667" y="148.16029393099998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">No lock</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 290.5974284033333 154.694375251 L 71.48620365366668 154.694375251" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(58.036886270000004,154.694375251) translate(-58.036886270000004,-154.694375251)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 71.64955568666667 147.88804054266666 L 58.036886270000004 154.694375251 L 71.64955568666667 161.50070995933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="354.92741897499997" y="179.197180201" width="103.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="357.37769947" y="193.898863171" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Check if locked</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.1579705366667 200.432944491 L 304.04674578699996 200.432944491" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(290.5974284033333,200.432944491) translate(-290.5974284033333,-200.432944491)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 304.21009782 193.62660978266666 L 290.5974284033333 200.432944491 L 304.21009782 207.23927919933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="380.42741897499997" y="224.935749441" width="52.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="382.87769947" y="239.637432411" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">No lock</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 290.5974284033333 246.171513731 L 509.708653153 246.171513731" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(523.1579705366667,246.171513731) translate(-523.1579705366667,-246.171513731)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 509.54530112 239.36517902266667 L 523.1579705366667 246.171513731 L 509.54530112 252.97784843933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="77.36687684166667" y="270.674318681" width="190.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="77.36687684166667" y="287.009521981" width="193.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="79.81715733666667" y="285.37600165099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request lock: new lock entry</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="79.81715733666667" y="301.71120495099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(id: lock_id1, status: ACTIVE)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 58.036886270000004 308.245286271 L 277.14811101966666 308.245286271" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(290.5974284033333,308.245286271) translate(-290.5974284033333,-308.245286271)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 276.98475898666663 301.43895156266666 L 290.5974284033333 308.245286271 L 276.98475898666663 315.05162097933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="104.36687684166667" y="332.748091221" width="139.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="106.81715733666667" y="347.44977419099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Check ACTIVE locks</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 58.036886270000004 353.983855511 L 277.14811101966666 353.983855511" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(290.5974284033333,353.983855511) translate(-290.5974284033333,-353.983855511)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 276.98475898666663 347.17752080266666 L 290.5974284033333 353.983855511 L 276.98475898666663 360.79019021933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="121.86687684166667" y="378.486660461" width="93.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="121.86687684166667" y="394.821863761" width="104.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="124.31715733666667" y="393.18834343099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return lock id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="124.31715733666667" y="409.52354673099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Lock obtained)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 290.5974284033333 416.057628051 L 71.48620365366668 416.057628051" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(58.036886270000004,416.057628051) translate(-58.036886270000004,-416.057628051)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 71.64955568666667 409.25129334266666 L 58.036886270000004 416.057628051 L 71.64955568666667 422.86396275933333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="309.92741897499997" y="440.560433001" width="190.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="309.92741897499997" y="456.89563630099997" width="193.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="312.37769947" y="455.26211597099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request lock: new lock entry</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="312.37769947" y="471.59731927099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(id: lock_id2, status: ACTIVE)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.1579705366667 478.131400591 L 304.04674578699996 478.131400591" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(290.5974284033333,478.131400591) translate(-290.5974284033333,-478.131400591)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 304.21009782 471.32506588266665 L 290.5974284033333 478.131400591 L 304.21009782 484.9377352993333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="336.92741897499997" y="502.6342055409999" width="139.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.37769947" y="517.3358885109999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Check ACTIVE locks</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.1579705366667 523.8699698309999 L 304.04674578699996 523.8699698309999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(290.5974284033333,523.8699698309999) translate(-290.5974284033333,-523.8699698309999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 304.21009782 517.0636351226666 L 290.5974284033333 523.8699698309999 L 304.21009782 530.6763045393333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="337.42741897499997" y="548.372774781" width="138.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="337.42741897499997" y="564.707978081" width="114.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.87769947" y="563.074457751" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return other lock ids</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.87769947" y="579.409661051" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Race Condition)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 290.5974284033333 585.943742371 L 509.708653153 585.943742371" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(523.1579705366667,585.943742371) translate(-523.1579705366667,-585.943742371)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 509.54530112 579.1374076626666 L 523.1579705366667 585.943742371 L 509.54530112 592.7500770793333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="325.42741897499997" y="610.446547321" width="162.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="325.42741897499997" y="626.781750621" width="134.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="327.87769947" y="625.148230291" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Cancel lock: update lock</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="327.87769947" y="641.483433591" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(status: ABORTED)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.1579705366667 648.017514911 L 304.04674578699996 648.017514911" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(290.5974284033333,648.017514911) translate(-290.5974284033333,-648.017514911)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 304.21009782 641.2111802026667 L 290.5974284033333 648.017514911 L 304.21009782 654.8238496193334 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 442.2886859166667 672.5203198610001 L 589.3255721866667 672.5203198610001 L 604.0272551566667 687.222002831 L 604.0272551566667 726.4264907510001 L 442.2886859166667 726.4264907510001 L 442.2886859166667 672.5203198610001 M 589.3255721866667 672.5203198610001 L 589.3255721866667 687.222002831 L 604.0272551566667 687.222002831" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="465.15797053666665" y="695.3896044810001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Back off</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="465.15797053666665" y="711.7248077810001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(random duration)</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.16760165 750.929295701 L 93.20448791999999 750.929295701 L 107.90617089 765.630978671 L 107.90617089 788.500263291 L 8.16760165 788.500263291 L 8.16760165 750.929295701 M 93.20448791999999 750.929295701 L 93.20448791999999 765.630978671 L 107.90617089 765.630978671" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="31.036886270000004" y="773.798580321" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Do work</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 482.7886859166666 813.0030682409999 L 548.8255721866666 813.0030682409999 L 563.5272551566666 827.7047512109999 L 563.5272551566666 850.574035831 L 482.7886859166666 850.574035831 L 482.7886859166666 813.0030682409999 M 548.8255721866666 813.0030682409999 L 548.8255721866666 827.7047512109999 L 563.5272551566666 827.7047512109999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="505.65797053666665" y="835.872352861" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Retry</text></g></g><g/><g/><g/></g></svg>